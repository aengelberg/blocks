<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>blocks.store.file documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Blocks</span> <span class="project-version">0.6.0</span></span></a></h1></div><div class="sidebar primary"><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blocks</span></div></div></li><li class="depth-2 branch"><a href="blocks.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch"><a href="blocks.data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2"><a href="blocks.store.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>buffer</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cache</span></div></a></li><li class="depth-3 branch current"><a href="blocks.store.file.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>file</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.memory.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>memory</span></div></a></li><li class="depth-3"><a href="blocks.store.replica.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replica</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="blocks.store.file.html#var-erase.21"><div class="inner"><span>erase!</span></div></a></li><li class="depth-1"><a href="blocks.store.file.html#var-file-store"><div class="inner"><span>file-store</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">blocks.store.file</h1><div class="doc"><div class="markdown"><p>Block storage backed by files in nested directories. Each block is stored in a separate file.</p>
<p>In many filesystems, performance degrades as the number of files in a directory grows. In order to reduce this impact and make navigating the blocks a bit more efficient, block files are stored in directories under the store root. All path elements are lower-case hex-encoded bytes from the multihash.</p>
<p>The directories under the root consist of the first four bytes of the multihashes of the blocks stored in them. Within each directory, blocks are stored in files whose names consist of the rest of their digests.</p>
<p>Thus, a block containing the content <code>foobar</code> would have the sha1 digest <code>97df3501149...</code> and be stored under the root directory at:</p>
<p><code>root/111497df/35011497df3588b5a3...</code></p>
<p>This implementation tries to match the IPFS fs-repo behavior so that the on-disk representations remain compatible.</p></div></div><div class="public anchor" id="var-erase.21"><h3>erase!</h3><div class="usage"><code>(erase! store)</code></div><div class="doc"><div class="markdown"><p>Clears all contents of the file store by recursively deleting the root directory.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/store/file.clj#L209">view source</a></div></div><div class="public anchor" id="var-file-store"><h3>file-store</h3><div class="usage"><code>(file-store root)</code></div><div class="doc"><div class="markdown"><p>Creates a new local file-based block store.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/store/file.clj#L217">view source</a></div></div></div></body></html>