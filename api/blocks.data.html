<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>blocks.data documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Blocks</span> <span class="project-version">1.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>blocks</span></div></div></li><li class="depth-2 branch"><a href="blocks.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2 branch current"><a href="blocks.data.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>store</span></div></div></li><li class="depth-3 branch"><a href="blocks.store.buffer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>buffer</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.cache.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>cache</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.file.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>file</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.memory.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>memory</span></div></a></li><li class="depth-3 branch"><a href="blocks.store.replica.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replica</span></div></a></li><li class="depth-3"><a href="blocks.store.tests.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tests</span></div></a></li><li class="depth-2"><a href="blocks.summary.html"><div class="inner"><span class="tree" style="top: -207px;"><span class="top" style="height: 216px;"></span><span class="bottom"></span></span><span>summary</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="blocks.data.html#var-checked-hasher"><div class="inner"><span>checked-hasher</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-clean-block"><div class="inner"><span>clean-block</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-content-stream"><div class="inner"><span>content-stream</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-lazy-block"><div class="inner"><span>lazy-block</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-load-block"><div class="inner"><span>load-block</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-merge-blocks"><div class="inner"><span>merge-blocks</span></div></a></li><li class="depth-1"><a href="blocks.data.html#var-read-block"><div class="inner"><span>read-block</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">blocks.data</h1><div class="doc"><div class="markdown"><p>Block type and constructor functions.</p>
<p>Blocks have two primary attributes, <code>:id</code> and <code>:size</code>. The block identifier is a <code>Multihash</code> with the digest identifying the content. The size is the number of bytes in the block content.</p>
<p>Internally, blocks either have in-memory content holding the data, or a reader function which returns new input streams for the block data. A block with in-memory content is a <em>loaded block</em>, while a block with a reader function is a <em>lazy block</em>.</p>
<p>A block’s id, size, content, and reader cannot be changed after construction, so clients can be relatively certain that the block’s id is valid. Blocks <em>may</em> have additional attributes associated with them and support metadata, similar to records.</p></div></div><div class="public anchor" id="var-checked-hasher"><h3>checked-hasher</h3><div class="usage"><code>(checked-hasher algorithm)</code></div><div class="doc"><div class="markdown"><p>Constructs a function for the given hash algorithm or function which checks that the result is a <code>Multihash</code>.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L208">view source</a></div></div><div class="public anchor" id="var-clean-block"><h3>clean-block</h3><div class="usage"><code>(clean-block block)</code></div><div class="doc"><div class="markdown"><p>Creates a version of the given block without extra attributes or metadata.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L289">view source</a></div></div><div class="public anchor" id="var-content-stream"><h3>content-stream</h3><div class="usage"><code>(content-stream block start end)</code></div><div class="doc"><div class="markdown"><p>Opens an input stream to read the contents of the block.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L232">view source</a></div></div><div class="public anchor" id="var-lazy-block"><h3>lazy-block</h3><div class="usage"><code>(lazy-block id size reader)</code></div><div class="doc"><div class="markdown"><p>Creates a block from a reader function. Each time the function is called, it should return a new <code>InputStream</code> to read the block contents. The block is given the id and size directly, without being checked.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L260">view source</a></div></div><div class="public anchor" id="var-load-block"><h3>load-block</h3><div class="usage"><code>(load-block id source)</code></div><div class="doc"><div class="markdown"><p>Creates a block by reading a source into memory. The block is given the id directly, without being checked.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L269">view source</a></div></div><div class="public anchor" id="var-merge-blocks"><h3>merge-blocks</h3><div class="usage"><code>(merge-blocks a b)</code></div><div class="doc"><div class="markdown"><p>Creates a new block by merging together two blocks representing the same content. Block ids and sizes must match. The new block’s content or reader comes from the second block, and any extra attributes and metadata are merged together.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L300">view source</a></div></div><div class="public anchor" id="var-read-block"><h3>read-block</h3><div class="usage"><code>(read-block algorithm source)</code></div><div class="doc"><div class="markdown"><p>Creates a block by reading the source into memory and hashing it.</p></div></div><div class="src-link"><a href="https://github.com/greglook/blocks/blob/master/src/blocks/data.clj#L279">view source</a></div></div></div></body></html>